﻿<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>

    <!--meta tags-->

    <meta charset="UTF-8">
    <meta name="description" content="Services Listing HTML5 CSS3 template">
    <meta name="keywords" content="HTML,CSS,XML,JavaScript, services, listing">
    <meta name="author" content="Ui-DesignLab">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--end meta tags-->

    <title>二手交易市场</title>
    <!--stylesheets-->
    <link rel="stylesheet" href="/vendor/css/bootstrap.min.css">
    <link rel="stylesheet" href="/vendor/css/animate.min.css">
    <link rel="stylesheet" href="/vendor/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/vendor/perfect-scrollbar/css/perfect-scrollbar.min.css">
    <link rel="stylesheet" href="/css/app.css">
    <!--end stylesheets-->

    <!--google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Cairo%7CNosifer%7CPoppins%7CQuicksand:700%7CRaleway%7CTangerine%7CHind+Vadodara" rel="stylesheet">
    <!--end google fonts-->
</head>
<body>


<!--导航栏-->
<div class="site-top-nav" th:insert="~{commons/commons::navigation}">
</div>

<!--banner-->
<div class="items-banner back-img">
    <h5>最简单的方法 <strong class="ui-text-info">卖出</strong> 物品</h5>
    <form action="#" method="post">
        <div class="mega-search">
            <input class="form-control" type="text" placeholder="在这里搜索..." id="search">
            <i class="fa fa-search"></i>
        </div>
        <button onclick="listGoods();return false;" class="ui-btn ui-btn-info btn-shadow"><strong>搜索</strong></button>
    </form>
</div>
<!--end banner-->


<!--items wrapper-->
<div class="items-wrapper">

        <strong>新上市产品</strong>
        <!--<div>-->
            <!--<span>排序方式 :</span>-->
            <!--<a href="#">时间</a>-->
            <!--<a href="#">价格</a>-->
            <!--<a href="#">名称</a>-->
        <!--</div>-->
        <div class="row" style="position:absolute;left:1300px;top:450px">
            <div class="col-lg-6 col-md-6">
                <div class="form-group">
                    <i style="position:relative;left:-100px;top:30px">排序方式 :</i>
                    <select class="form-control" style="width: 200px; " name="sortByType" id="sortByType" onchange="listGoods()">
                        <option value=" g.`date_up` DESC">最新上架</option>
                        <option value="g.`price` DESC">价格降序</option>
                        <option value="g.`price` asc">价格升序</option>
                    </select>
                </div>
            </div>
        </div>

    <div class="items" id="items">
        <div class="sale-item">
            <div class="sale-item-img">
                <img src="/img/items/app3.jpg" alt="">
                <div class="sale-info">
                    <strong>物品名称</strong>
                    <span class="sale-price">$637.00</span>
                </div>
            </div>
            <div class="sale-lister">
                <div class="lister-pic">
                    <div><img src="/img/lister.jpg" alt=""></div>
                    <div>
                        <strong>张三丰</strong>
                        <span><i class="fa fa-map-marker"></i><em>澳门</em></span>
                    </div>
                </div>
                <a href="item-detail.html"><i class="fa fa-angle-right fa-2x"></i></a>
            </div>
        </div>

    </div>
</div>
<!--end items wrapper-->

<!--site pagination-->
<div class="site-pagination">
    <div class="pagination"  id="pageId">
        <a href="javascript:void(0)" type="upPage"><i class="fa fa-angle-left"></i>&nbsp;<em>上一页</em></a>
        <a href="javascript:void(0)"><span><i>1</i></span></a>
        <a href="javascript:void(0)" class="current"><span><i>2</i></span></a>
        <a href="javascript:void(0)"><span><i>3</i></span></a>
        <a href="javascript:void(0)"  type="upPage"><em>下一页</em>&nbsp;<i class="fa fa-angle-right"></i></a>
    </div>
</div>

<!--start here-->
<div class="start-here">
    <h3>从这里开始</h3>
    <p>

    </p>
    <div class="divide">
        <a href="login-register.html" class="ui-btn ui-btn-info">登录</a>
        <strong class="ui-text-success">或</strong>
        <a href="login-register.html" class="ui-btn ui-btn-prim">注册</a>
    </div>
</div>
<!--end start here-->

<!--chat box-->
<a href="#" class="chat-box-btn"><i class="fa fa-comment icon-sw"></i></a>

<!--咨询窗口-->
<div class="chat-box">
    <div class="chat-top">
        <section>
            <h6 class="org-name">二手交易平台</h6>
            <div class="repliers">
                <div class="r-img">
                    <img src="/img/avatar2.jpg" alt="">
                    <strong class="name">Megan</strong>
                </div>
                <div class="r-img">
                    <img src="/img/user2.jpg" alt="">
                    <strong class="name">Brandon</strong>
                </div>
            </div>
        </section>
    </div>
    <div class="chat-flow" id="chat-flow">
        <p class="outbound">
            Hallo, 有人在吗？
        </p>
        <p class="inbound">
            嗨, 在的，很乐意为您效劳.
        </p>
    </div>
    <form class="chat-form" action="#">
        <input type="text" class="form-control chat-message" placeholder="回复">
    </form>
</div>

<!--end chat box-->

<!--page loader-->
<div class="page-loader">
    <div class="loader"><img src="/img/logo.png" alt=""></div>
</div>
<!--end page loader-->

<!--footer section-->
<div class="bottom-strip">
    <div class="copyright" style="margin: 0 auto">
        <i class="fa fa-copyright"></i>
        <span>二手交易平台. 保留所有解释权利</span>
    </div>
</div>
<!--end footer section-->

<!--scripts-->
<script src="/vendor/js/jquery-3.2.1.min.js"></script>
<script src="/vendor/js/popper.js"></script>
<script src="/vendor/js/bootstrap.min.js"></script>
<script src="/vendor/js/alertify.js"></script>
<script src="/vendor/js/jquery.knob.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="/vendor/js/excanvas.js"></script><![endif]-->
<script src="/vendor/js/summernote-bs4.min.js"></script>
<script src="/vendor/js/dropzone.js"></script>
<script src="/vendor/OwlCarousel2-2.2.1/owl.carousel.min.js"></script>
<script src="/vendor/perfect-scrollbar/js/perfect-scrollbar.jquery.min.js"></script>
<script src="/vendor/js/typed.js"></script>
<script src="/js/app.js"></script>
<script src="/js/bootstrap-paginator.js"></script>
<!--end scripts-->

<script>
    $(function () {
        listGoods();
    })
    function listGoods(nowPage,size) {
        //获取查询关键字,排序类型
        var keyword= $("#search").val();
        var type=$("#sortByType").val();
        // alert("keyword="+keyword+",type="+type+",nowpage="+nowPage+",<>size="+size)

        $.ajax({
            url:"/items/queryGoods",
            method:"post",
            dataType:"json",
            data:{keyword:keyword,type:type,pageNum:nowPage,pageSize:8},
            success:function (data) {
                console.log(data);
                var v = "";
                for (var i = 0; i < data.list.length; i++) {

                    var dateTime = data.list[i].dateUp;
                    var d = dateTime.toString().substring(0,10);

                    var localTime = getLocalTime(d);
                    v += "<div class=\"sale-item\">\n" +
                        "<div class=\"sale-item-img\">\n" +
                        "<img src=\"/img/items/app3.jpg\" alt=\"\">\n" +
                        "<div class=\"sale-info\">\n" +
                        "<strong>" + data.list[i].goodsName + "</strong>\n" +
                        "<span class=\"sale-price\" style='font-size: 30px'>$" + data.list[i].price + "</span>\n" +
                        "</div>\n" +
                        "</div>\n" +
                        "<div class=\"sale-lister\">\n" +
                        "<div class=\"lister-pic\">\n" +
                        "<div><img src=\"/img/lister.jpg\" alt=\"\"></div>\n" +
                        "<div>\n" +
                        "<strong style='font-size: 18px'>" + "卖家："+data.list[i].userName + "</strong>\n" +
                        "<span style='font-size: 14px' id='goods_date'>" + localTime + "</span>\n" +
                        "</div>\n" +
                        "</div>\n" +
                        "<a href=\"item-detail.html?id=" + data.list[i].goodsid + "\"><i class=\"fa fa-angle-right fa-2x\"></i></a>\n" +
                        "</div>\n" +
                        "</div>"
                }
                $("#items").html(v);

                //当前页
                var now = data.pageNum;
                //页数
                var pageCount = data.pages;

                var temp = "";
                //上一页
                temp += "<a href=\"javascript:listGoods(" + (data.pageNum - 1) + ")\" type=\"upPage\" nowPage='-1'><i class=\"fa fa-angle-left\"></i>&nbsp;<em>上一页</em></a>";

                //加载数字  1- pageCount
                for (var i = 1; i <= pageCount; i++) {
                    temp += "<a href=\"javascript:listGoods(" + i + ")\" class=\"current\" nowPage='" + i + "' type='num'><span><i>" + i + "</i></span></a>";
                }
                //下一页
                temp += "<a href=\"javascript:listGoods(" + (data.pageNum + 1) + ")\"  type='downPage' nowPage='-1'><em>下一页</em>&nbsp;<i class=\"fa fa-angle-right\"></i></a>\n" +
                    "                ;\n" +
                    "  ";

                $("#pageId").html(temp);

                var link = document.createElement("link");

                $(".current").removeAttr("class", "current");
                var a = $("[type='num']");

                for (i = 0, len = a.length; i < len; i++) {
                    if (a[i].href == window.location.href) {
                        $(this).attr("class", "current");
                    }
                }
            }
        })
    }
    function getLocalTime(timestamp) {
        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        Y = date.getFullYear() + '-';
        M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
        D = date.getDate() + ' ';
        h = date.getHours() + ':';
        m = date.getMinutes() + ':';
        s = date.getSeconds();
        return Y+M+D+h+m+s;
    }
</script>

</body>
</html>
